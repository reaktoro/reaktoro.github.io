<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How to perform chemical equilibrium calculations</title>

    <link href="../../_static/css/theme.css" rel="stylesheet" />
    <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />


    <link rel="stylesheet" href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">





    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/customized_mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />

    <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/customize.js"></script>
    <script>
        var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';
    </script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/reaktoro-logo.svg" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to specify equilibrium constraints" href="howto-specify-equilibrium-constraints.html" />
    <link rel="prev" title="How to specify activity models" href="howto-specify-activity-models.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />

</head>

<body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">

    <div class="container-fluid" id="banner"></div>



    <div class="container-xl">
        <div class="row">

            <div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">

                <div class="navbar-brand-box">
                    <a class="navbar-brand text-wrap" href="../../index.html">

                        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->



                        <img src="../../_static/reaktoro-for-python-and-cpp.svg" class="logo" alt="logo">


                    </a>
                </div>
                <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
                    <i class="icon fas fa-search"></i>
                    <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off">
                </form>
                <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
                    <div class="bd-toc-item active">
                        <p class="caption" role="heading">
                            <span class="caption-text">
  Get Started
 </span>
                        </p>
                        <ul class="current nav bd-sidenav">
                            <li class="toctree-l1 has-children">
                                <a class="reference internal" href="../installation/index.html">
   Installation
  </a>
                                <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox" />
                                <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
                                <ul>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="../installation/installation-using-conda.html">
     Installation using Conda
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="../installation/installation-using-cmake.html">
     Installation using CMake
    </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="toctree-l1 current active has-children">
                                <a class="reference internal" href="index.html">
   Learn
  </a>
                                <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox" />
                                <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
                                <ul class="current">
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-import-reaktoro.html">
     How to use Reaktoro
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-use-databases.html">
     How to load and use thermodynamic databases
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-use-other-supported-databases.html">
     How to load other supported thermodynamic databases
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-define-chemical-systems.html">
     How to define chemical systems
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-define-chemical-states.html">
     How to create and define chemical states
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-compute-chemical-properties.html">
     How to compute chemical properties
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-compute-aqueous-properties.html">
     How to compute aqueous properties
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-specify-activity-models.html">
     How to specify activity models
    </a>
                                    </li>
                                    <li class="toctree-l2 current active">
                                        <a class="current reference internal" href="#">
     How to perform chemical equilibrium calculations
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-specify-equilibrium-constraints.html">
     How to specify equilibrium constraints
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="howto-perform-kinetics-calculations.html">
     How to perform chemical kinetics calculations
    </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference external" href="https://reaktoro.org/api">
   API Reference
  </a>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference external" href="https://reaktoro.org/v1">
   Reaktoro v1
  </a>
                            </li>
                        </ul>
                        <p class="caption" role="heading">
                            <span class="caption-text">
  Tutorials
 </span>
                        </p>
                        <ul class="nav bd-sidenav">
                            <li class="toctree-l1 has-children">
                                <a class="reference internal" href="../../tutorials/equilibrium/index.html">
   Chemical Equilibrium
  </a>
                                <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox" />
                                <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
                                <ul>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="../../tutorials/equilibrium/solubility-calcite-water.html">
     Solubility of calcite in pure water
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="../../tutorials/equilibrium/fixed-ph.html">
     Chemical equilibrium with fixed pH
    </a>
                                    </li>
                                    <li class="toctree-l2">
                                        <a class="reference internal" href="../../tutorials/equilibrium/fixed-fugacity.html">
     Chemical equilibrium with fixed fugacity
    </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <p class="caption" role="heading">
                            <span class="caption-text">
  About Reaktoro
 </span>
                        </p>
                        <ul class="nav bd-sidenav">
                            <li class="toctree-l1">
                                <a class="reference internal" href="../../about/citing.html">
   Citing
  </a>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference internal" href="../../about/faq.html">
   FAQ
  </a>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference internal" href="../../about/troubleshooting.html">
   Troubleshooting
  </a>
                            </li>
                            <li class="toctree-l1">
                                <a class="reference internal" href="../../about/license.html">
   License
  </a>
                            </li>
                        </ul>

                    </div>
                </nav>
                <!-- To handle the deprecated key -->

                <div class="navbar_extra_footer">
                    Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
                </div>

            </div>






            <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">

                <div class="topbar container-xl fixed-top">
                    <div class="topbar-contents row">
                        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
                        <div class="col pl-md-4 topbar-main">

                            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>


                            <div class="dropdown-buttons-trigger">
                                <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

                                <div class="dropdown-buttons">
                                    <!-- ipynb file if we had a myst markdown file -->

                                    <!-- Download raw file -->
                                    <a class="dropdown-buttons" href="../../_sources/get-started/learn/howto-perform-equilibrium-calculations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
                                    <!-- Download PDF via print -->
                                    <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
                                </div>
                            </div>

                            <!-- Source interaction buttons -->

                            <div class="dropdown-buttons-trigger">
                                <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
                                <div class="dropdown-buttons sourcebuttons">
                                    <a class="repository-button" href="https://github.com/reaktoro/reaktoro-jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
                                    <a class="issues-button" href="https://github.com/reaktoro/reaktoro-jupyter-book/issues/new?title=Issue%20on%20page%20%2Fget-started/learn/howto-perform-equilibrium-calculations.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>

                                </div>
                            </div>

                            <!-- Full screen (wrap in <a> to have style consistency -->

                            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

                            <!-- Launch buttons -->

                            <div class="dropdown-buttons-trigger">
                                <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
                                <div class="dropdown-buttons">

                                    <a class="binder-button" href="https://mybinder.org/v2/gh/reaktoro/reaktoro-jupyter-book/main?urlpath=tree/get-started/learn/howto-perform-equilibrium-calculations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>




                                </div>
                            </div>

                        </div>

                        <!-- Table of contents -->
                        <div class="d-none d-md-block col-md-2 bd-toc show">

                            <div class="tocsection onthispage pt-5 pb-3">
                                <i class="fas fa-list"></i> Contents
                            </div>
                            <nav id="bd-toc-nav" aria-label="Page">
                                <ul class="visible nav section-nav flex-column">
                                    <li class="toc-h2 nav-item toc-entry">
                                        <a class="reference internal nav-link" href="#calculation-with-given-temperatures-and-pressures">
   Calculation with given temperatures and pressures
  </a>
                                    </li>
                                    <li class="toc-h2 nav-item toc-entry">
                                        <a class="reference internal nav-link" href="#calculation-with-given-aqueous-solution-ph">
   Calculation with given aqueous solution pH
  </a>
                                    </li>
                                    <li class="toc-h2 nav-item toc-entry">
                                        <a class="reference internal nav-link" href="#calculation-with-given-volume-and-internal-energy">
   Calculation with given volume and internal energy
  </a>
                                    </li>
                                    <li class="toc-h2 nav-item toc-entry">
                                        <a class="reference internal nav-link" href="#checking-if-the-calculation-was-successful">
   Checking if the calculation was successful
  </a>
                                    </li>
                                    <li class="toc-h2 nav-item toc-entry">
                                        <a class="reference internal nav-link" href="#calculations-with-given-initial-element-amounts">
   Calculations with given initial element amounts
  </a>
                                    </li>
                                </ul>

                            </nav>
                        </div>
                    </div>
                </div>
                <div id="main-content" class="row">
                    <div class="col-12 col-md-9 pl-md-3 pr-md-0">

                        <div>

                            <div class="tex2jax_ignore mathjax_ignore section" id="how-to-perform-chemical-equilibrium-calculations">
                                <h1>How to perform chemical equilibrium calculations<a class="headerlink" href="#how-to-perform-chemical-equilibrium-calculations" title="Permalink to this headline">¶</a></h1>
                                <p>This section is under construction!</p>

                                <p>Reaktoro performs chemical equilibrium calculations by <em>minimizing the system’s Gibbs energy</em> <span id="id1">[<a class="reference internal" href="../bibliography.html#id667">Leal <em>et al.</em>, 2017</a>]</span>.
                                    In a Gibbs energy minimization problem, temperature and pressure are prescribed. The chemical system is considered <strong>closed</strong> (the mass of the chemical elements and the electrical charge are conserved in
                                    the reactive process). We give a simple example below in which we use class <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1EquilibriumSolver.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a>                                    to perform the chemical equilibrium calculation.</p>
                                <div class="cell docutils container">
                                    <div class="cell_input docutils container">
                                        <div class="highlight-ipython3 notranslate">
                                            <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reaktoro</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">NasaDatabase</span><span class="p">(</span><span class="s2">&quot;nasa-cea&quot;</span><span class="p">)</span>

<span class="n">gases</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">GaseousPhase</span><span class="p">(</span><span class="s2">&quot;CH4 O2 CO2 CO H2O H2&quot;</span><span class="p">)</span>

<span class="n">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalSystem</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">gases</span><span class="p">)</span>

<span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">temperature</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">pressure</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== INITIAL STATE ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="n">solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumSolver</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">solver</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>  <span class="c1"># compute the state of chemical equilibrium!</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== FINAL STATE ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
                                        </div>
                                    </div>
                                    <div class="cell_output docutils container">
                                        <div class="output stream highlight-myst-ansi notranslate">
                                            <div class="highlight"><pre><span></span>=== INITIAL STATE ===
+-----------------+---------+------+
| Property        |   Value | Unit |
+-----------------+---------+------+
| Temperature     | 1273.15 |    K |
| Pressure        |   1e+07 |   Pa |
| Charge:         |       0 |  mol |
| Element Amount: |         |      |
| :: H            |       4 |  mol |
| :: C            |       1 |  mol |
| :: O            |       1 |  mol |
| Species Amount: |         |      |
| :: CH4          |       1 |  mol |
| :: O2           |     0.5 |  mol |
| :: CO2          |   1e-16 |  mol |
| :: CO           |   1e-16 |  mol |
| :: H2O          |   1e-16 |  mol |
| :: H2           |   1e-16 |  mol |
+-----------------+---------+------+
=== FINAL STATE ===
+-----------------+-----------+------+
| Property        |     Value | Unit |
+-----------------+-----------+------+
| Temperature     |   1273.15 |    K |
| Pressure        |     1e+07 |   Pa |
| Charge:         |         0 |  mol |
| Element Amount: |           |      |
| :: H            |         4 |  mol |
| :: C            |         1 |  mol |
| :: O            |         1 |  mol |
| Species Amount: |           |      |
| :: CH4          |  0.376062 |  mol |
| :: O2           |     1e-16 |  mol |
| :: CO2          | 0.0936296 |  mol |
| :: CO           |  0.530308 |  mol |
| :: H2O          |  0.282433 |  mol |
| :: H2           |  0.965442 |  mol |
+-----------------+-----------+------+
</pre></div>
                                        </div>
                                    </div>
                                </div>
                                <p>The final mole composition above was found by minimizing the Gibbs energy of the system. Note that the initial and final amounts of the elements H, C, and O are identical (the same would apply to the electric charge of
                                    the system if there were charged species in the problem).</p>
                                <p>However, there are many different classes of equilibrium problems where:</p>
                                <ul class="simple">
                                    <li>
                                        <p><strong>temperature and/or pressure may be unknown</strong> (e.g., combustion in a rigid and adiabatic chamber where volume and internal energy are specified and temperature and pressure are calculated);</p>
                                    </li>
                                    <li>
                                        <p><strong>the chemical system is open to certain substances</strong> (e.g., aqueous solution in equilibrium with a mixture of gases with known partial pressures or fugacities, such as the atmosphere).</p>
                                    </li>
                                </ul>
                                <p>Reaktoro’s chemical equilibrium algorithm supports all these types of cases because it implements an algorithm to solve <em>parametric Gibbs energy minimization problems with general equilibrium constraints</em>. Thus,
                                    Reaktoro is not restricted to closed systems and prescribed conditions of temperature and pressure, as we will see in the next sections.</p>
                                <div class="admonition note">
                                    <p class="admonition-title">Note</p>
                                    <p>If you’ve read the previous guides, you’ve probably already encountered the use of <code class="docutils literal notranslate"><span class="pre">equilibrate(state)</span></code> to bring <code class="docutils literal notranslate"><span class="pre">state</span></code>,
                                        an object of class <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1ChemicalState.html"><code class="docutils literal notranslate"><span class="pre">ChemicalState</span></code></a>,
                                        to a state of chemical equilibrium. This method exists for convenience and performs a Gibbs energy minimization on the entire chemical system. It is equivalent to using
                                        <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1EquilibriumSolver.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a> as follows:</p>
                                    <div class="highlight-py notranslate">
                                        <div class="highlight"><pre><span></span><span class="n">solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumSolver</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">solver</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
                                    </div>
                                </div>
                                <div class="admonition tip">
                                    <p class="admonition-title">Tip</p>
                                    <p>If you need many equilibrium calculations (e.g. in the context of reactive transport simulations), consider using the
                                        <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1EquilibriumSolver.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a> class instead of the <code class="docutils literal notranslate"><span class="pre">equilibrate</span></code> method,
                                        as the latter creates an <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1EquilibriumSolver.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a>                                        object during each call without reuse afterwards, which can cause computation overhead.</p>
                                </div>
                                <div class="section" id="calculation-with-given-temperatures-and-pressures">
                                    <h2>Calculation with given temperatures and pressures<a class="headerlink" href="#calculation-with-given-temperatures-and-pressures" title="Permalink to this headline">¶</a></h2>
                                </div>
                                <div class="section" id="calculation-with-given-aqueous-solution-ph">
                                    <h2>Calculation with given aqueous solution pH<a class="headerlink" href="#calculation-with-given-aqueous-solution-ph" title="Permalink to this headline">¶</a></h2>
                                    <p>Fixing the pH of an aqueous solution is a common procedure in biogeochemical modeling. This requires, however, the introduction of a new <em>degree of freedom</em> in the problem. This is because we cannot, in general,
                                        obtain a desired pH without titrating a substance in the solution. Thus, in the example given below, the system will be open to a substance: H<sup>+</sup>. <em>The unknown amount of H<sup>+</sup> necessary to enter or leave the system to attain the requested pH is the new degree of freedom</em>,
                                        and is calculated along with the amounts of species in equilibrium.</p>
                                    <div class="admonition note">
                                        <p class="admonition-title">Note</p>
                                        <p>The choice of H<sup>+</sup> as the <em>titrant</em> when fixing the pH of an aqueous solution may seem arbitrary and unintuitive to some coming from a different background or experienced with another convention
                                            used by other chemical modeling codes. For example, it can be questioned that a charged species not found isolated in nature (compared to HCl, for example) is chosen as the titrant. However, there are mathematical
                                            reasons behind this choice that make the problem to be solved more simply and efficiently. We will give examples later on how to combine this pH constraint with other conditions to demonstrate the full potential
                                            of this convention.</p>
                                    </div>
                                    <p>For our example, let’s define a simple aqueous phase:</p>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">PhreeqcDatabase</span><span class="p">(</span><span class="s2">&quot;pitzer.dat&quot;</span><span class="p">)</span>

<span class="n">solution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">AqueousPhase</span><span class="p">(</span><span class="s2">&quot;H2O H+ OH- Na+ Cl- HCO3- CO2 CO3-2&quot;</span><span class="p">)</span>

<span class="n">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalSystem</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <p>For this system, let’s create a chemical state representing a 1 molal NaCl solution with 0.4 molal dissolved CO<sub>2</sub>:</p>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">temperature</span><span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">pressure</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;atm&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;kg&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;Na+&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;Cl-&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="calculation-with-given-volume-and-internal-energy">
                                    <h2>Calculation with given volume and internal energy<a class="headerlink" href="#calculation-with-given-volume-and-internal-energy" title="Permalink to this headline">¶</a></h2>
                                    <p>Let’s consider again the combustion of 1 mol of CH<sub>4</sub> and 0.5 mol of O<sub>2</sub>. This time, however, we will not specify temperature and pressure, but volume and internal energy. This is to model the combustion
                                        of this gas mixture in a rigid and adiabatic chamber.</p>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="n">state0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">state0</span><span class="p">.</span><span class="nf">temperature</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>
<span class="n">state0</span><span class="p">.</span><span class="nf">pressure</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">state0</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="n">state0</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>

<span class="n">props0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalProps</span><span class="p">(</span><span class="n">state0</span><span class="p">)</span>

<span class="n">V0</span> <span class="o">=</span> <span class="n">props0</span><span class="p">.</span><span class="nf">volume</span><span class="p">()</span>  <span class="c1"># the initial volume of the gases</span>
<span class="n">U0</span> <span class="o">=</span> <span class="n">props0</span><span class="p">.</span><span class="nf">internalEnergy</span><span class="p">()</span>  <span class="c1"># the initial internal energy of the gases</span>
</pre></div>
                                            </div>
                                        </div>
                                        <div class="cell_output docutils container">
                                            <div class="output traceback highlight-ipythontb notranslate">
                                                <div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_9874</span><span class="o">/</span><span class="mf">2886579036.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">state0</span><span class="p">.</span><span class="nf">temperature</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">state0</span><span class="p">.</span><span class="nf">pressure</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">state0</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">state0</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>

<span class="ne">RuntimeError</span>: ***ERROR*** Could not find any Species object with name CH4.
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="n">specs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumSpecs</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">specs</span><span class="p">.</span><span class="nf">volume</span><span class="p">()</span>
<span class="n">specs</span><span class="p">.</span><span class="nf">internalEnergy</span><span class="p">()</span>

<span class="n">conditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumConditions</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span>
<span class="n">conditions</span><span class="p">.</span><span class="nf">volume</span><span class="p">(</span><span class="n">V0</span><span class="p">)</span>
<span class="n">conditions</span><span class="p">.</span><span class="nf">internalEnergy</span><span class="p">(</span><span class="n">U0</span><span class="p">)</span>

<span class="n">conditions</span><span class="p">.</span><span class="nf">setLowerBoundPressure</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">conditions</span><span class="p">.</span><span class="nf">setLowerBoundTemperature</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>

<span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">state0</span><span class="p">)</span>

<span class="n">solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumSolver</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span>
<span class="n">solver</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">conditions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
                                            </div>
                                        </div>
                                        <div class="cell_output docutils container">
                                            <div class="output stream highlight-myst-ansi notranslate">
                                                <div class="highlight"><pre><span></span>+-----------------+-----------+------+
| Property        |     Value | Unit |
+-----------------+-----------+------+
| Temperature     |   1230.15 |    K |
| Pressure        |    768530 |   Pa |
| Charge:         |         0 |  mol |
| Element Amount: |           |      |
| :: H            |         4 |  mol |
| :: C            |         1 |  mol |
| :: O            |         1 |  mol |
| Species Amount: |           |      |
| :: CH4          |  0.102994 |  mol |
| :: O2           |     1e-16 |  mol |
| :: CO2          | 0.0261655 |  mol |
| :: CO           |   0.87084 |  mol |
| :: H2O          | 0.0768286 |  mol |
| :: H2           |   1.71718 |  mol |
+-----------------+-----------+------+
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Let’s see different use cases for <a class="reference external" href="https://reaktoro.org/api/classReaktoro_1_1EquilibriumSolver.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a>                                        in the next sections.</p>
                                </div>
                                <div class="section" id="checking-if-the-calculation-was-successful">
                                    <h2>Checking if the calculation was successful<a class="headerlink" href="#checking-if-the-calculation-was-successful" title="Permalink to this headline">¶</a></h2>
                                    <p>Performing chemical equilibrium calculations is not a trivial task. It involves highly complicated algorithms to solve different mathematical problems (eg non-linear equations, matrix equations). Therefore, it is possible
                                        that a calculation could fail. This can happen due to many factors. However, the most common are:</p>
                                    <ul class="simple">
                                        <li>
                                            <p>the formulation of the equilibrium problem is ill-formed (e.g. specifying a set of conflicting equilibrium constraints that cannot be achieved chemically/thermodynamically)</p>
                                        </li>
                                        <li>
                                            <p>the use of poor initial guesses.</p>
                                        </li>
                                    </ul>
                                    <p>So you might want to check at the end of each equilibrium calculation if it was successful:</p>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">temperature</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;celsius&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">pressure</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>

<span class="n">solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumSolver</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Succeesful?&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">optima</span><span class="o">.</span><span class="n">succeeded</span><span class="p">)</span>
</pre></div>
                                            </div>
                                        </div>
                                        <div class="cell_output docutils container">
                                            <div class="output stream highlight-myst-ansi notranslate">
                                                <div class="highlight"><pre><span></span>Succeesful? True
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <p>The object <code class="docutils literal notranslate"><span class="pre">result</span></code> above is of type
                                        <a class="reference external" href="https://reaktoro.org/api/structReaktoro_1_1EquilibriumResult.html"><code class="docutils literal notranslate"><span class="pre">EquilibriumResult</span></code></a> and it also contains other details about the calculation, such as the number of iterations needed for convergence:</p>
                                    <div class="cell docutils container">
                                        <div class="cell_input docutils container">
                                            <div class="highlight-ipython3 notranslate">
                                                <div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">optima</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span>
</pre></div>
                                            </div>
                                        </div>
                                        <div class="cell_output docutils container">
                                            <div class="output stream highlight-myst-ansi notranslate">
                                                <div class="highlight"><pre><span></span>Iterations: 27
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="calculations-with-given-initial-element-amounts">
                                    <h2>Calculations with given initial element amounts<a class="headerlink" href="#calculations-with-given-initial-element-amounts" title="Permalink to this headline">¶</a></h2>
                                </div>
                            </div>

                            <script type="text/x-thebe-config">
                                { requestKernel: true, binderOptions: { repo: "binder-examples/jupyter-stacks-datascience", ref: "master", }, codeMirrorConfig: { theme: "abcdef", mode: "python" }, kernelOptions: { kernelName: "python3", path: "./get-started/learn" }, predefinedOutput:
                                true }
                            </script>
                            <script>
                                kernelName = 'python3'
                            </script>

                        </div>






                        <div class='prev-next-bottom'>

                            <div id="prev">
                                <a class="left-prev" href="howto-specify-activity-models.html" title="previous page">
                                    <i class="prevnext-label fas fa-angle-left"></i>
                                    <div class="prevnext-info">
                                        <p class="prevnext-label">previous</p>
                                        <p class="prevnext-title">How to specify activity models</p>
                                    </div>
                                </a>
                            </div>
                            <div id="next">
                                <a class="right-next" href="howto-specify-equilibrium-constraints.html" title="next page">
                                    <div class="prevnext-info">
                                        <p class="prevnext-label">next</p>
                                        <p class="prevnext-title">How to specify equilibrium constraints</p>
                                    </div>
                                    <i class="prevnext-label fas fa-angle-right"></i>
                                </a>
                            </div>

                        </div>

                    </div>
                </div>
                <footer class="footer">
                    <div class="container">
                        <p>

                            &copy; Copyright 2022.<br/>
                        </p>
                    </div>
                </footer>
            </main>


        </div>
    </div>

    <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>


</body>

</html>
                    </div>
                </div>
                <footer class="footer">
                    <div class="container">
                        <p>

                            &copy; Copyright 2022.<br/>
                        </p>
                    </div>
                </footer>
            </main>


        </div>
    </div>

    <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>


</body>

</html>