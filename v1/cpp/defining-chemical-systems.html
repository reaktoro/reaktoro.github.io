<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta name="generator" content="Doxygen 1.9.4" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reaktoro: Defining the Chemical System</title>
  <!-- <link href="tabs.css" rel="stylesheet" type="text/css"/>  --> <!-- REMOVED BY DOXYSTRAP -->
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/mhchem.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> --> <!-- REMOVED BY DOXYSTRAP -->
  <link href="css/doxystrap.css" rel="stylesheet" type="text/css" />
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link href="css/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="js/bootstrap.min.js" type="text/javascript"></script>
  <script src="js/doxystrap.js" type="text/javascript"></script>
  <script src="js/jquery.fancybox.min.js" type="text/javascript"></script>
  <link href="css/reaktoro.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <!-- BEGIN DOXYSTRAP -->
    <div class="content" id="content">
      <div class="container">
    <!-- END DOXYSTRAP -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr style="height: 56px;">
                <td id="projectlogo"><a href="../index.html"><img alt="Logo" src="reaktoro.svg" /></a></td>
                <td id="projectalign" style="padding-left: 0.5em;">
                  <div id="projectname">Reaktoro
                  </div>
                  <div id="projectbrief">A unified framework for modeling chemically reactive systems</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- BEGIN DOXYSTRAP -->
        <div class="row">
          <div class="col-sm-12 panel " style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
        <!-- END DOXYSTRAP -->
              <!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorial.html">Tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Defining the Chemical System </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#what-is-chemical-system">What is a chemical system?</a><ul><li class="level2"><a href="#realism-efficiency">Deciding between chemical realism and computational efficiency</a></li>
</ul>
</li>
<li class="level1"><a href="#how-define">Defining chemical systems in Reaktoro</a><ul><li class="level2"><a href="#using-chemicaleditor">Using class ChemicalEditor</a></li>
<li class="level2"><a href="#using-gems">Using class Gems</a></li>
<li class="level2"><a href="#using-phreeqc">Using class Phreeqc</a></li>
<li class="level2"><a href="#using-phreeqc-editor">Using class PhreeqcEditor</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_docs_doxystrap_src_tutorial_defining_chemical_systems"></a></p>
<p >In <a class="el" href="namespaceReaktoro.html" title="The namespace containing all components of the Reaktoro library.">Reaktoro</a>, we need to define our chemical system in order to perform chemical reaction calculations.</p>
<h1><a class="anchor" id="what-is-chemical-system"></a>
What is a chemical system?</h1>
<p >A chemical system is a description of the phases of interest in the modeling problem and the chemical species that compose those phases. For example, when modeling the chemistry of an aqueous solution, only one phase should be enough, an <em>aqueous phase</em>. If one is interested in modeling the solubility of gases in an aqueous solution, then it makes sense to also define a <em>gaseous phase</em> with one or more gases. When modeling aqueous solutions and minerals, under a variety of temperature, pressure, and chemical conditions, it might make sense to define the chemical system with many <em>mineral phases</em>.</p>
<h2><a class="anchor" id="chemical-thermo-models"></a>
Chemical and Thermodynamic Models for the Phases</h2>
<p >Specifying the phases and their species is not enough to fully describe a chemical system in the <em>computational sense</em>. Every phase in Reaktoro has two associated models: a <em>thermodynamic model</em> and a <em>chemical model</em>. These denominations are not standard in the literature, but they are useful in the differentiation of two needed types of models for a phase.</p>
<p >A <em>thermodynamic model</em> is a model for the calculation of <em>standard thermodynamic properties</em> of the species. Examples include standard Gibbs energies, or standard chemical potentials, standard molar volumes, standard heat capacities, standard enthalpies, and so forth. These models are functions of <em>temperature</em> and <em>pressure</em> only. Currently, Reaktoro natively supports only SUPCRT92 databases, which contains parameters for the revised <em>Helgeson-Kirkham-Flowers</em> (HKF) equations of state for the calculation of standard thermodynamic properties for hundreds of aqueous species, at temperatures 0 to 1000 Â°C and pressures 1 to 5000 bar. The SUPCRT92 databases also contain Maier&ndash;Kelly coefficients for the calculation of standard thermodynamic properties of gases and minerals.</p>
<p >A <em>chemical model</em> is a model that describes the <em>non-ideal behavior</em> of phases. These models not only depend on temperature and pressure, like the thermodynamic models, but also on the amounts of the species in the phase. To be more precise, on the concentrations of these species, which can be calculated from the amounts of the species.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Continue discussion on chemical and thermodynamic models.</dd></dl>
<h2><a class="anchor" id="realism-efficiency"></a>
Deciding between chemical realism and computational efficiency</h2>
<p >One can define a chemical system with many phases, each phase containing one or more species. This does not mean that all phases and their species exist at positive amounts! What it means is that the chemical calculations, equilibrium or kinetics, are capable of deciding if a phase in the chemical system should exist at positive amounts for some given conditions (e.g., temperature, pressure, overall composition).</p>
<p >By selecting as many phases as possible, with the possibilities constrained by the <em>thermodynamic database</em> being used, one can increase the confidence level of the estimated chemical states. Note, however, that accurate and realistic estimates depend on many more factors than just the selection of potential phases, such as the <em>choice of thermodynamic models for non-ideal phases</em>. Furthermore, note that adding too many phases and species to the definition of the chemical system can result in <em>more computationally expensive</em> chemical calculations. In critical performance applications, such as when combining chemical reactions and fluid flow and species transport modeling, restricting the number of phases and species might be necessary for achieving feasible simulation times. The modeler is responsible to decide to which extent the number of phases and species can be compromised for efficiency reasons at the expense of chemical realism!</p>
<h1><a class="anchor" id="how-define"></a>
Defining chemical systems in Reaktoro</h1>
<p >Defining a chemical system in Reaktoro can be done in different ways: all of them ultimately producing an object of class <a class="el" href="classReaktoro_1_1ChemicalSystem.html">ChemicalSystem</a>. In what follows, we demonstrate how such ChemicalSystem object can be created.</p>
<h2><a class="anchor" id="using-chemicaleditor"></a>
Using class ChemicalEditor</h2>
<p >Reaktoro implements the class <a class="el" href="classReaktoro_1_1ChemicalEditor.html">ChemicalEditor</a> to facilitate the definition of a chemical system. To define a chemical system with only one aqueous phase, using the thermodynamic database supcrt98.xml, one does:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor;(<span class="stringliteral">&quot;supcrt98.xml&quot;</span>);</div>
<div class="line">editor.addAqueousPhase({<span class="stringliteral">&quot;H2O(l)&quot;</span>, <span class="stringliteral">&quot;H+&quot;</span>, <span class="stringliteral">&quot;OH-&quot;</span>, <span class="stringliteral">&quot;Na+&quot;</span>, <span class="stringliteral">&quot;Cl-&quot;</span>});</div>
<div class="line"> </div>
<div class="line">ChemicalSystem system = editor;</div>
<div class="ttc" id="anamespaceReaktoro_html"><div class="ttname"><a href="namespaceReaktoro.html">Reaktoro</a></div><div class="ttdoc">The namespace containing all components of the Reaktoro library.</div><div class="ttdef"><b>Definition:</b> ChemicalScalar.hpp:24</div></div>
</div><!-- fragment --><p >The aqueous phase is constructed with just five aqueous species. The species names must be written exactly as in the specified database, otherwise an error will occur! Once all phases, and their species have been specified in the <code>ChemicalEditor</code> object, one can now convert <code>editor</code> into an object of class <code>ChemicalSystem</code>, which can be done using the assignment operator <code>=</code>, which is programmed to work as a conversion operator:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalSystem system = editor;</div>
</div><!-- fragment --><p >In Python, however, the equivalent code would be:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">system = ChemicalSystem(editor)</div>
</div><!-- fragment --><p >In some occasions, it would be preferable to just specify a few compound or substance names, <em>not necessarily named as in the database</em>, and then let <code>ChemicalEditor</code> to automatically select all chemical species that could be formed out of the combination of those compounds. In this case, one no longer uses a list of species names, but a string containing all compound names that represents the phase. For the previous H2O&ndash;NaCl aqueous solution, the aqueous phase would be defined as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addAqueousPhase(<span class="stringliteral">&quot;H2O NaCl&quot;</span>);</div>
</div><!-- fragment --><p >Neither <code>H2O</code> nor <code>NaCl</code> are species names in the <code>supcrt98.xml</code> database. Internally, a parser in Reaktoro is used to decompose each compound or substance name into a list of chemical elements and their number of atoms. For example, parsing <code>H2O</code> would produce <code>{{"H", 2}, {"O", 1}}</code>. After this is done for all substance names, <code>ChemicalEditor</code> is then programmed to search in the database for all aqueous species that can be formed with these chemical elements. Because of this, one should expect many more chemical species in the aqueous phase than possibly necessary for the modeling application. If many chemical calculations are needed, so that computational time is critical in your application, then manually selecting the major chemical species might be a preferred option. This could be done by the modeler after a few analysis to detect which aqueous species are present in significant amounts in all or most possible conditions expected in the modeling.</p>
<p >To define a chemical system with a gaseous phase, say, for example, a H2O&ndash;NaCl&ndash;CO2 system, one does:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addAqueousPhase(<span class="stringliteral">&quot;H2O NaCl CO2&quot;</span>);</div>
<div class="line">editor.addGaseousPhase(<span class="stringliteral">&quot;H2O CO2&quot;</span>);</div>
</div><!-- fragment --><p >However, as mentioned above, this might result in many more species than needed, especially for the gaseous phase. For example, the resulting gaseous phase will most probably contain gases that might not be of interest for a H2O&ndash;NaCl&ndash;CO2 system, such as <code>CH4(g)</code>, <code>CO(g)</code>, <code>H2(g)</code>, <code>O2(g)</code>, etc. If water vapor, <code>H2O(g)</code>, and gaseous/supercritical carbon dioxide, <code>CO2(g)</code>, suffices, then the gaseous phase can be defined using:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addGaseousPhase({<span class="stringliteral">&quot;H2O(g)&quot;</span>, <span class="stringliteral">&quot;CO2(g)&quot;</span>});</div>
</div><!-- fragment --><p >In most geochemical modeling applications, one or more mineral phases are needed. In most cases, these mineral phases are <em>pure mineral phases</em>, i.e., they contain only one mineral species. When they contain more than one, they are often called <em>solid solutions</em>. Defining a pure mineral phase or a solid solution phase is similar to defining any other phase type. The code below demonstrates the definition of a H2O&ndash;NaCl&ndash;CaCl2&ndash;MgCl2&ndash;CO2 system with pure mineral phases halite (NaCl), calcite (CaCO3), magnesite (MgCO3), and dolomite (CaMg(CO3)2):</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor;(<span class="stringliteral">&quot;supcrt98.xml&quot;</span>);</div>
<div class="line">editor.addAqueousPhase(<span class="stringliteral">&quot;H2O NaCl CaCl2 MgCl2 CO2&quot;</span>);</div>
<div class="line">editor.addGaseousPhase({<span class="stringliteral">&quot;H2O(g)&quot;</span>, <span class="stringliteral">&quot;CO2(g)&quot;</span>});</div>
<div class="line">editor.addMineralPhase(<span class="stringliteral">&quot;Halite&quot;</span>);</div>
<div class="line">editor.addMineralPhase(<span class="stringliteral">&quot;Calcite&quot;</span>);</div>
<div class="line">editor.addMineralPhase(<span class="stringliteral">&quot;Magnesite&quot;</span>);</div>
<div class="line">editor.addMineralPhase(<span class="stringliteral">&quot;Dolomite&quot;</span>);</div>
<div class="line"> </div>
<div class="line">ChemicalSystem system = editor;</div>
</div><!-- fragment --><p >To define a solid solution phase, one would proceed similarly as done before for aqueous and gaseous phases:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addMineralPhase({<span class="stringliteral">&quot;Calcite&quot;</span>, <span class="stringliteral">&quot;Magnesite&quot;</span>});</div>
</div><!-- fragment --><p >The code below demonstrate how an aqueous phase can be constructed and then have its default <em>chemical model</em> changed to the Debye&ndash;Huckel model:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor; {<span class="keyword">delete</span>}</div>
<div class="line">AqueousPhase aqueousphase = editor.addAqueousPhase(<span class="stringliteral">&quot;H2O NaCl CO2&quot;</span>);</div>
<div class="line">aqueousphase.setChemicalModelDebyeHuckel();</div>
</div><!-- fragment --><p >In general, chemical models for aqueous phases Note that activity models are also needed for neutral species. If none are provided, then an ideal model is used in which their activity coefficients are one. For some neutral aqueous species, such as <code>CO2(aq)</code>, predefined models exists and for those </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor; {<span class="keyword">delete</span>}</div>
<div class="line">aqueousphase.setActivityModelDrummondCO2();</div>
<div class="line">aqueousphase.setActivityModelSetschenow(<span class="stringliteral">&quot;NaCl(aq)&quot;</span>, 0.1);</div>
</div><!-- fragment --><p >The method <code>ChemicalEditor::addAqueousPhase</code> returns an object of class <code>AqueousPhase</code>. After its creation, the user can use the <code>aqueousphase</code> object to set, for example, the Debye&ndash;Huckel model as the chemical model of the aqueous phase, which is used, among other things, to to calculate the activities of the aqueous species:</p>
<h2><a class="anchor" id="using-gems"></a>
Using class Gems</h2>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">Gems gems(<span class="stringliteral">&quot;some-gems-project-file.lst&quot;</span>);</div>
<div class="line"> </div>
<div class="line">ChemicalSystem system = editor;</div>
</div><!-- fragment --><h2><a class="anchor" id="using-phreeqc"></a>
Using class Phreeqc</h2>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">Phreeqc phreeqc;(<span class="stringliteral">&quot;some-phreeqc-database-file.dat&quot;</span>);</div>
<div class="line">phreeqc.execute(<span class="stringliteral">&quot;some-phreeqc-script-file.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line">ChemicalSystem system = phreeqc;</div>
</div><!-- fragment --><h2><a class="anchor" id="using-phreeqc-editor"></a>
Using class PhreeqcEditor</h2>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">PhreeqcEditor editor;(<span class="stringliteral">&quot;some-phreeqc-database-file.dat&quot;</span>);</div>
<div class="line">editor.setAqueousPhase(<span class="stringliteral">&quot;H O C Na Cl Ca Mg&quot;</span>);</div>
<div class="line">editor.setGaseousPhase({<span class="stringliteral">&quot;CO2(g)&quot;</span>});</div>
<div class="line">editor.setMineralPhases({<span class="stringliteral">&quot;Calcite&quot;</span>, <span class="stringliteral">&quot;Dolomite&quot;</span>});</div>
<div class="line"> </div>
<div class="line">ChemicalSystem system = editor;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 12 2022 23:22:02 for Reaktoro by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
