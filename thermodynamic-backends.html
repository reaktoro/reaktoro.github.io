

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Thermodynamic Backends &mdash; Reaktoro  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgements" href="acknowledgements.html" />
    <link rel="prev" title="Thermodynamic Databases" href="thermodynamic-databases.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Reaktoro
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Programming Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/equilibrium/index.html">Chemical Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/kinetics/index.html">Chemical Kinetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/transport/index.html">Chemical Transport</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="thermodynamic-databases.html">Thermodynamic Databases</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Thermodynamic Backends</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Reaktoro</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Thermodynamic Backends</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/thermodynamic-backends.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="thermodynamic-backends">
<h1>Thermodynamic Backends<a class="headerlink" href="#thermodynamic-backends" title="Permalink to this headline">Â¶</a></h1>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/reaktoro/reaktoro-jupyter/master?filepath=tutorial%2Foverview.ipynb"><img alt="https://img.shields.io/badge/Reaktoro%20Tutorial-Interactive!-E66581.svg?logo=data:image/png;base64,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" src="https://img.shields.io/badge/Reaktoro%20Tutorial-Interactive!-E66581.svg?logo=data:image/png;base64,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" /></a>
<p>There are excellent and mature open-source software for modeling chemical
systems for which development and maintenance has been ongoing for several
years to a few decades. Wouldnât it be great if Reaktoro could use the best
these software can offer in terms of thermodynamic databases and activity
models as <em>thermodynamic backends</em>, while relying on Reaktoroâs numerical
algorithms for the intense chemical reaction calculations? Well, it turns out
this is already supported for two widely used geochemical modeling codes:
<a class="reference external" href="http://wwwbrr.cr.usgs.gov/projects/GWC_coupled/phreeqc/">PHREEQC</a> and <a class="reference external" href="http://gems.web.psi.ch/">GEMS</a>.</p>
<div class="figure align-center" id="id1" style="width: 80%">
<a class="reference external image-reference" href="http://wwwbrr.cr.usgs.gov/projects/GWC_coupled/phreeqc/"><img alt="_images/phreeqc-logo.svg" src="_images/phreeqc-logo.svg" width="50%" /></a>
<p class="caption"><span class="caption-text">PHREEQC is a computer program for speciation, batch-reaction,
one-dimensional transport, and inverse geochemical calculations developed
by USGS, United States.</span><a class="headerlink" href="#id1" title="Permalink to this image">Â¶</a></p>
</div>
<div class="figure align-center" id="id2" style="width: 80%">
<a class="reference external image-reference" href="http://gems.web.psi.ch/"><img alt="_images/gems-logo.png" src="_images/gems-logo.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-text">GEMS is a Gibbs energy minimization software for geochemical modeling
developed at Paul Scherrer Institute, Switzerland.</span><a class="headerlink" href="#id2" title="Permalink to this image">Â¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Neither PHREEQC nor GEMS are used in Reaktoro for solving the underlying
mathematical problems for chemical equilibrium and kinetics. These backends
act as providers of thermodynamic properties of species, phases, and
reactions (e.g., activity coefficients, activities, standard chemical
potentials, phase molar volume and enthalpy, equilibrium constant of
reaction). Whenever Reaktoroâs numerical algorithms need these properties,
the thermodynamic backend is invoked to retrieve them in a very efficient
way by directly using its API. It seems complicated, but rest assure, the
usage is rather simple as youâll see below!</p>
</div>
<div class="section" id="phreeqc-backend">
<h2>PHREEQC Backend<a class="headerlink" href="#phreeqc-backend" title="Permalink to this headline">Â¶</a></h2>
<p>The code below demonstrates the combined use of Reaktoro and PHREEQC to perform
a chemical equilibrium calculation in which PHREEQC thermodynamic data and
activity models are used together with Reaktoroâs Gibbs energy minimization
algorithm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reaktoro</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># This string defines a PHREEQC script problem.</span>
<span class="c1"># This problem was taken from the official PHREEQC example named ex1.</span>
<span class="n">ex1</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;&#39;(</span>
<span class="s1">TITLE Example 1.--Add uranium and speciate seawater.</span>
<span class="s1">SOLUTION 1  SEAWATER FROM NORDSTROM AND OTHERS (1979)</span>
<span class="s1">        units   ppm</span>
<span class="s1">        pH      8.22</span>
<span class="s1">        pe      8.451</span>
<span class="s1">        density 1.023</span>
<span class="s1">        temp    25.0</span>
<span class="s1">        redox   O(0)/O(-2)</span>
<span class="s1">        Ca              412.3</span>
<span class="s1">        Mg              1291.8</span>
<span class="s1">        Na              10768.0</span>
<span class="s1">        K               399.1</span>
<span class="s1">        Fe              0.002</span>
<span class="s1">        Mn              0.0002  pe</span>
<span class="s1">        Si              4.28</span>
<span class="s1">        Cl              19353.0</span>
<span class="s1">        Alkalinity      141.682 as HCO3</span>
<span class="s1">        S(6)            2712.0</span>
<span class="s1">        N(5)            0.29    gfw   62.0</span>
<span class="s1">        N(-3)           0.03    as    NH4</span>
<span class="s1">        U               3.3     ppb   N(5)/N(-3)</span>
<span class="s1">        O(0)            1.0     O2(g) -0.7</span>
<span class="s1">SOLUTION_MASTER_SPECIES</span>
<span class="s1">        U       U+4     0.0     238.0290     238.0290</span>
<span class="s1">        U(4)    U+4     0.0     238.0290</span>
<span class="s1">        U(5)    UO2+    0.0     238.0290</span>
<span class="s1">        U(6)    UO2+2   0.0     238.0290</span>
<span class="s1">SOLUTION_SPECIES</span>
<span class="s1">        #primary master species for U</span>
<span class="s1">        #is also secondary master species for U(4)</span>
<span class="s1">        U+4 = U+4</span>
<span class="s1">                log_k          0.0</span>
<span class="s1">        U+4 + 4 H2O = U(OH)4 + 4 H+</span>
<span class="s1">                log_k          -8.538</span>
<span class="s1">                delta_h        24.760 kcal</span>
<span class="s1">        U+4 + 5 H2O = U(OH)5- + 5 H+</span>
<span class="s1">                log_k          -13.147</span>
<span class="s1">                delta_h        27.580 kcal</span>
<span class="s1">        #secondary master species for U(5)</span>
<span class="s1">        U+4 + 2 H2O = UO2+ + 4 H+ + e-</span>
<span class="s1">                log_k          -6.432</span>
<span class="s1">                delta_h        31.130 kcal</span>
<span class="s1">        #secondary master species for U(6)</span>
<span class="s1">        U+4 + 2 H2O = UO2+2 + 4 H+ + 2 e-</span>
<span class="s1">                log_k          -9.217</span>
<span class="s1">                delta_h        34.430 kcal</span>
<span class="s1">        UO2+2 + H2O = UO2OH+ + H+</span>
<span class="s1">                log_k          -5.782</span>
<span class="s1">                delta_h        11.015 kcal</span>
<span class="s1">        2UO2+2 + 2H2O = (UO2)2(OH)2+2 + 2H+</span>
<span class="s1">                log_k          -5.626</span>
<span class="s1">                delta_h        -36.04 kcal</span>
<span class="s1">        3UO2+2 + 5H2O = (UO2)3(OH)5+ + 5H+</span>
<span class="s1">                log_k          -15.641</span>
<span class="s1">                delta_h        -44.27 kcal</span>
<span class="s1">        UO2+2 + CO3-2 = UO2CO3</span>
<span class="s1">                log_k          10.064</span>
<span class="s1">                delta_h        0.84 kcal</span>
<span class="s1">        UO2+2 + 2CO3-2 = UO2(CO3)2-2</span>
<span class="s1">                log_k          16.977</span>
<span class="s1">                delta_h        3.48 kcal</span>
<span class="s1">        UO2+2 + 3CO3-2 = UO2(CO3)3-4</span>
<span class="s1">                log_k          21.397</span>
<span class="s1">                delta_h        -8.78 kcal</span>
<span class="s1">PHASES</span>
<span class="s1">        Uraninite</span>
<span class="s1">        UO2 + 4 H+ = U+4 + 2 H2O</span>
<span class="s1">        log_k          -3.490</span>
<span class="s1">        delta_h        -18.630 kcal</span>
<span class="s1">END</span>
<span class="s1">)&#39;&#39;&#39;</span>

<span class="c1"># Initialize a Phreeqc instance with the official phreeqc.dat database file</span>
<span class="n">phreeqc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Phreeqc</span><span class="p">(</span><span class="s1">&#39;../../databases/phreeqc/phreeqc.dat&#39;</span><span class="p">)</span>

<span class="c1"># Execute a PHREEQC script defining a geochemical problem.</span>
<span class="c1"># Here this script is actually embedded into a string named `ex1`.</span>
<span class="c1"># However, `ex1` could also be a string containing the path to a script file.</span>
<span class="c1"># Method execute will automatically identify when the contents are embedded in</span>
<span class="c1"># the string and when the string is actually a path to a script file.</span>
<span class="n">phreeqc</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">ex1</span><span class="p">)</span>

<span class="c1"># Initialize a ChemicalSystem instance using the current state of the Phreeqc</span>
<span class="c1"># instance. This will allow the use of both PHREEQC thermodynamic data and</span>
<span class="c1"># PHREEQC activity models in the subsequent equilibrium calculations using</span>
<span class="c1"># Reaktoro&#39;s algorithms.</span>
<span class="n">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalSystem</span><span class="p">(</span><span class="n">phreeqc</span><span class="p">)</span>

<span class="c1"># Initialize an ChemicalState instance using the current state of the</span>
<span class="c1"># Phreeqc instance.</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">phreeqc</span><span class="p">.</span><span class="nf">state</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

<span class="c1"># Output the equilibrium state calculated by PHREEQC to a file.</span>
<span class="n">state</span><span class="p">.</span><span class="nf">output</span><span class="p">(</span><span class="s1">&#39;state-phreeqc.txt&#39;</span><span class="p">)</span>

<span class="c1"># Define an equilibrium problem in which the current state is mixed with 1</span>
<span class="c1"># mmol of HCl.</span>
<span class="n">problem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumProblem</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">problem</span><span class="p">.</span><span class="nf">setTemperature</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="nf">temperature</span><span class="p">())</span>
<span class="n">problem</span><span class="p">.</span><span class="nf">setPressure</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="nf">pressure</span><span class="p">())</span>
<span class="n">problem</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">problem</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="s1">&#39;HCl&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;mmol&#39;</span><span class="p">)</span>

<span class="c1"># Set Hessian of Gibbs energy to an approximation, since PHREEQC does not </span>
<span class="c1"># compute molar derivatives of activities </span>
<span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EquilibriumOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">GibbsHessian</span><span class="o">.</span><span class="n">Approximation</span>

<span class="c1"># Calculate the new equilibrium state of the system.</span>
<span class="c1"># This will use both PHREEQC thermodynamic data and PHREEQC activity models.</span>
<span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalState</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="nf">equilibrate</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

<span class="c1"># Print the new equilibrium state and check with pH is more acidic now.</span>
<span class="n">state</span><span class="p">.</span><span class="nf">output</span><span class="p">(</span><span class="s1">&#39;state-phreeqc-updated.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Python and C++ files for this demo:</dt><dd><div class="line-block">
<div class="line"><a class="reference download internal" download="" href="_downloads/543ca645c07bf3dc3eaa5dc37e779a2d/demo-backends-phreeqc.py"><code class="xref download docutils literal notranslate"><span class="pre">demo-backends-phreeqc.py</span></code></a></div>
<div class="line"><a class="reference download internal" download="" href="_downloads/a237fb53adbd7ef953109e60c4b00c38/demo-backends-phreeqc.cpp"><code class="xref download docutils literal notranslate"><span class="pre">demo-backends-phreeqc.cpp</span></code></a></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="gems-backend">
<h2>GEMS Backend<a class="headerlink" href="#gems-backend" title="Permalink to this headline">Â¶</a></h2>
<p>Similarly, the code below briefly demonstrates how Reaktoro and GEMS can be
used together. Youâll need first to prepare your chemical system definition
using GEM-Selektor, the graphical user interface of GEMS. In this step, youâll
be able to select which GEMSâ supported thermodynamic database you want to use
as well as the activity models for each phase (aqueous, gaseous, solid
solutions). Next, export the GEMS project files to disk, and use it in Reaktoro
as shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reaktoro</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># **Note:**</span>
<span class="c1"># This demo should be executed in the same directory where the script is located.</span>
<span class="c1"># Example:</span>
<span class="c1"># ~~~</span>
<span class="c1"># cd Reaktoro/demos/python</span>
<span class="c1"># python demo-equilibrium-gems.py</span>
<span class="c1"># ~~~</span>

<span class="c1"># Use an exported project file from GEMS to initialize a Gems object,</span>
<span class="n">gems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Gems</span><span class="p">(</span><span class="s2">&quot;../resources/gems/CalciteBC-dat.lst&quot;</span><span class="p">)</span>

<span class="c1"># and then use it to construct the ChemicalSystem object.</span>
<span class="n">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ChemicalSystem</span><span class="p">(</span><span class="n">gems</span><span class="p">)</span>

<span class="c1"># Create a ChemicalState object that contains the temperature, pressure,</span>
<span class="c1"># and amounts of species stored in the exported GEMS file.</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">gems</span><span class="p">.</span><span class="nf">state</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

<span class="c1"># Output the equilibrium state calculated by GEMS to a file.</span>
<span class="n">state</span><span class="p">.</span><span class="nf">output</span><span class="p">(</span><span class="s2">&quot;state-gems.txt&quot;</span><span class="p">)</span>

<span class="c1"># Perturb the equilibrium state calculated by GEMS</span>
<span class="n">state</span><span class="p">.</span><span class="nf">setSpeciesAmount</span><span class="p">(</span><span class="s2">&quot;CO2@&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># and then equilibrate the modified chemical state using Reaktoro&#39;s methods.</span>
<span class="nf">equilibrate</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="c1"># Output the updated equilibrium state to a file.</span>
<span class="n">state</span><span class="p">.</span><span class="nf">output</span><span class="p">(</span><span class="s2">&quot;state-gems-updated.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Python and C++ files for this demo:</dt><dd><div class="line-block">
<div class="line"><a class="reference download internal" download="" href="_downloads/bbc98618823a7610ca32b2d20a7cc407/demo-backends-gems.py"><code class="xref download docutils literal notranslate"><span class="pre">demo-backends-gems.py</span></code></a></div>
<div class="line"><a class="reference download internal" download="" href="_downloads/f015bb96c5e3c8e19a601b32512bba30/demo-backends-gems.cpp"><code class="xref download docutils literal notranslate"><span class="pre">demo-backends-gems.cpp</span></code></a></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="what-about-more-thermodynamic-backends">
<h2>What about more thermodynamic backends?<a class="headerlink" href="#what-about-more-thermodynamic-backends" title="Permalink to this headline">Â¶</a></h2>
<p>Are there other chemical reaction modeling software that you think could be
integrated with Reaktoro as <em>thermodynamic backends</em>? Let us know by creating a
new issue at <a class="reference external" href="https://github.com/reaktoro/reaktoro/issues/new">Reaktoroâs GitHub Issues</a>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>It would be great if you could contribute to expanding the list of
supported Reaktoroâs thermodynamic backends. Contributions can be made in
several forms, ranging from direct code contribution to financing a project
in which one or more experts will implement this.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="acknowledgements.html" class="btn btn-neutral float-right" title="Acknowledgements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="thermodynamic-databases.html" class="btn btn-neutral float-left" title="Thermodynamic Databases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Allan Leal and Reaktoro contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>