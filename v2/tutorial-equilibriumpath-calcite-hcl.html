<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta name="generator" content="Doxygen 1.9.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reaktoro: Calculating the equilibrium reaction path of a H&lt;sub&gt;2&lt;/sub&gt;O–HCl–CaCO&lt;sub&gt;3&lt;/sub&gt; system</title>
  <!-- <link href="tabs.css" rel="stylesheet" type="text/css"/>  --> <!-- REMOVED BY DOXYSTRAP -->
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/mhchem.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> --> <!-- REMOVED BY DOXYSTRAP -->
  <link href="css/doxystrap.css" rel="stylesheet" type="text/css" />
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link href="css/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="js/bootstrap.min.js" type="text/javascript"></script>
  <script src="js/doxystrap.js" type="text/javascript"></script>
  <script src="js/jquery.fancybox.min.js" type="text/javascript"></script>
  <link href="css/reaktoro.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <!-- BEGIN DOXYSTRAP -->
    <div class="content" id="content">
      <div class="container">
    <!-- END DOXYSTRAP -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr style="height: 56px;">
                <td id="projectlogo"><a href="../index.html"><img alt="Logo" src="reaktoro.svg" /></a></td>
                <td id="projectalign" style="padding-left: 0.5em;">
                  <div id="projectname">Reaktoro
                    &#160;<span id="projectnumber">2.0</span>
                  </div>
                  <div id="projectbrief">A unified framework for modeling chemically reactive systems</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- BEGIN DOXYSTRAP -->
        <div class="row">
          <div class="col-sm-12 panel " style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
        <!-- END DOXYSTRAP -->
              <!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorial.html">Tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Calculating the equilibrium reaction path of a H<sub>2</sub>O–HCl–CaCO<sub>3</sub> system </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_doxystrap_src_tutorial_tutorial_equilibriumpath_calcite_hcl"></a> Consider two different chemical states in equilibrium: an <em>initial state</em> and a <em>final state</em>. These states can have different temperatures, pressures, and/or molar amounts of elements. If we gradually adjust temperature, pressure, and elemental amounts in the system to bring the initial state to the final state, slowly enough so that <b>every intermediate state is in equilibrium</b>, the system would trace a path, which we call <em>reaction path</em>.</p>
<p>Let's say we initially have 1 g of calcite (CaCO3) mixed with 1 kg of water. We want to see how the addition of hydrochloric acid (HCl), up to 1 mmol, contributes to the dissolution of calcite. Thus, our initial and final states for a reaction path calculation can be described as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Initial state   </th><th class="markdownTableHeadNone">Final state    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 kg of H2O   </td><td class="markdownTableBodyNone">1 kg of H2O    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1 g of CaCO3   </td><td class="markdownTableBodyNone">1 g of CaCO3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">1 mmol of HCl   </td></tr>
</table>
<p>We show below the code for doing this reaction path calculation using <a class="el" href="namespaceReaktoro.html" title="The namespace containing all components of the Reaktoro library.">Reaktoro</a>, followed by comments of each newly introduced C++ component:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Reaktoro/Reaktoro.hpp&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    ChemicalEditor editor;</div>
<div class="line">    editor.addAqueousPhase(<span class="stringliteral">&quot;H O Ca C Cl&quot;</span>);</div>
<div class="line">    editor.addMineralPhase(<span class="stringliteral">&quot;Calcite&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalSystem system;(editor);</div>
<div class="line"> </div>
<div class="line">    EquilibriumProblem problem1;(system);</div>
<div class="line">    problem1.setTemperature(30.0, <span class="stringliteral">&quot;celsius&quot;</span>);</div>
<div class="line">    problem1.setPressure(1.0, <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line">    problem1.add(<span class="stringliteral">&quot;H2O&quot;</span>, 1, <span class="stringliteral">&quot;kg&quot;</span>);</div>
<div class="line">    problem1.add(<span class="stringliteral">&quot;CaCO3&quot;</span>, 1, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    EquilibriumProblem problem2;(system);</div>
<div class="line">    problem2.setTemperature(30.0, <span class="stringliteral">&quot;celsius&quot;</span>);</div>
<div class="line">    problem2.setPressure(1.0, <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line">    problem2.add(<span class="stringliteral">&quot;H2O&quot;</span>, 1, <span class="stringliteral">&quot;kg&quot;</span>);</div>
<div class="line">    problem2.add(<span class="stringliteral">&quot;CaCO3&quot;</span>, 1, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line">    problem2.add(<span class="stringliteral">&quot;HCl&quot;</span>, 1, <span class="stringliteral">&quot;mmol&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalState state1 = equilibrate(problem1);</div>
<div class="line">    ChemicalState state2 = equilibrate(problem2);</div>
<div class="line"> </div>
<div class="line">    EquilibriumPath path;(system);</div>
<div class="line"> </div>
<div class="line">    ChemicalPlot plot1 = path.plot();</div>
<div class="line">    plot1.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">    plot1.y(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">    plot1.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">    plot1.ylabel(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">    plot1.showlegend(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalPlot plot2 = path.plot();</div>
<div class="line">    plot2.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">    plot2.y(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca&quot;</span>);</div>
<div class="line">    plot2.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">    plot2.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>);</div>
<div class="line">    plot2.legend(<span class="stringliteral">&quot;right center&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalPlot plot3 = path.plot();</div>
<div class="line">    plot3.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">    plot3.y(<span class="stringliteral">&quot;speciesMolality(CO2(aq) units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO2(aq)&quot;</span>);</div>
<div class="line">    plot3.y(<span class="stringliteral">&quot;speciesMolality(CO3-- units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO3--&quot;</span>);</div>
<div class="line">    plot3.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">    plot3.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>);</div>
<div class="line">    plot3.legend(<span class="stringliteral">&quot;right top&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalPlot plot4 = path.plot();</div>
<div class="line">    plot4.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">    plot4.y(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>, <span class="stringliteral">&quot;Calcite&quot;</span>);</div>
<div class="line">    plot4.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">    plot4.ylabel(<span class="stringliteral">&quot;Mass [g]&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ChemicalOutput output = path.output();</div>
<div class="line">    output.filename(<span class="stringliteral">&quot;result.txt&quot;</span>);</div>
<div class="line">    output.add(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>, <span class="stringliteral">&quot;Cl [mmol]&quot;</span>);</div>
<div class="line">    output.add(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca [mmolal]&quot;</span>);</div>
<div class="line">    output.add(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">    output.add(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    path.solve(state1, state2);</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceReaktoro_html"><div class="ttname"><a href="namespaceReaktoro.html">Reaktoro</a></div><div class="ttdoc">The namespace containing all components of the Reaktoro library.</div><div class="ttdef"><b>Definition:</b> Algorithms.hpp:25</div></div>
</div><!-- fragment --><p>In the code above, two instances of class EquilibriumProblem are created: <code>problem1</code> describes the initial state, and <code>problem2</code> the final state. Two instances of class <a class="el" href="classReaktoro_1_1ChemicalState.html">ChemicalState</a> are then created to store the initial and final equilibrium states calculated by method equilibrate.</p>
<p>Note that, differently from the previous code example, the object <code>editor</code> from class ChemicalEditor was not initialized with a given <a class="el" href="classReaktoro_1_1Database.html">Database</a> object. Instead, it was initialized using the default built-in database file <code>supcrt98.xml</code>. Also note that the aqueous species were not listed, but the chemical elements composing the phase. When chemical element names are specified during the creation of a phase, like in:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addAqueousPhase(<span class="stringliteral">&quot;H O Ca C Cl&quot;</span>);</div>
</div><!-- fragment --><p>class ChemicalEditor searches for all species in the database that can be formed by those elements. Only species corresponding to the phase type being created is selected (e.g., only aqueous species are searched in the above case).</p>
<p>Once the initial and final equilibrium states have been calculated, it is now time to trace the reaction path between them, with each intermediate state in chemical equilibrium. For this, we use the class EquilibriumPath. Note that its initialization requires a <a class="el" href="classReaktoro_1_1ChemicalSystem.html">ChemicalSystem</a> instance:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path(system);</div>
</div><!-- fragment --><p>A reaction path calculation is better analyzed using plots. Before the method EquilibriumPath::solve is called, one can configure plots to be generated during the calculation. These plots are generated by <a href="http://www.gnuplot.info/">Gnuplot</a>, so ensure it is installed in your system to be able to see these plots. There are four configured plots in the above equilibrium path calculation. The first plot is defined as:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path;(system); {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalPlot plot1 = path.plot();</div>
<div class="line">plot1.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">plot1.y(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">plot1.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">plot1.ylabel(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">plot1.showlegend(<span class="keyword">false</span>);</div>
</div><!-- fragment --><p>which sets the <em>x</em>-axis to the amount of element Cl, in units of mmol, and the <em>y</em>-axis to the pH of the aqueous phase, resulting in the following figure:</p>
<p> 
<div class="image">
<a href="img/equilibrium-path-calcite-hcl-1.svg"
    data-fancybox="gallery1"
    data-caption="Tracing the change in pH with the gradual addition of HCl.">
    <img src="img/equilibrium-path-calcite-hcl-1.svg" width=400></a>
</div>
</p>
<p>The second plot is defined as:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path;(system); {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalPlot plot2 = path.plot();</div>
<div class="line">plot2.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">plot2.y(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca&quot;</span>);</div>
<div class="line">plot2.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">plot2.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>);</div>
<div class="line">plot2.legend(<span class="stringliteral">&quot;right center&quot;</span>);</div>
</div><!-- fragment --><p>which now sets the <em>x</em>-axis to the pH of the aqueous phase and the <em>y</em>-axis to the molality of element Ca, i.e., the molar amount of Ca <b>in the aqueous phase</b>, divided by the mass of solvent water H2O(l). This results in the following figure:</p>
<p> 
<div class="image">
<a href="img/equilibrium-path-calcite-hcl-2.svg"
    data-fancybox="gallery1"
    data-caption="Tracing the change in concentration of element Ca in the aqueous solution with the gradual addition of HCl.">
    <img src="img/equilibrium-path-calcite-hcl-2.svg" width=400></a>
</div>
</p>
<p>The third figure is produced with the following code:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path;(system); {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalPlot plot3 = path.plot();</div>
<div class="line">plot3.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">plot3.y(<span class="stringliteral">&quot;speciesMolality(CO2(aq) units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO2(aq)&quot;</span>);</div>
<div class="line">plot3.y(<span class="stringliteral">&quot;speciesMolality(CO3-- units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO3--&quot;</span>);</div>
<div class="line">plot3.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">plot3.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>);</div>
<div class="line">plot3.legend(<span class="stringliteral">&quot;right top&quot;</span>);</div>
</div><!-- fragment --><p>which also sets the <em>x</em>-axis to pH, but the <em>y</em>-axis now contains two plotted quantities: the molality of species CO2(aq) and the molality of species CO3&ndash;, both in units of mmolal (i.e., mmol/kgH2O). This produces the following figure:</p>
<p> 
<div class="image">
<a href="img/equilibrium-path-calcite-hcl-3.svg"
    data-fancybox="gallery1"
    data-caption="Tracing the concentrations of species CO2(aq) and CO3-- with the gradual addition of HCl.">
    <img src="img/equilibrium-path-calcite-hcl-3.svg" width=400></a>
</div>
</p>
<p>The fourth and last figure finally plots how the mass of calcite (or calcium carbonate) changes with the addition of HCl in the system:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path;(system); {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalPlot plot4 = path.plot();</div>
<div class="line">plot4.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>);</div>
<div class="line">plot4.y(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>, <span class="stringliteral">&quot;Calcite&quot;</span>);</div>
<div class="line">plot4.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>);</div>
<div class="line">plot4.ylabel(<span class="stringliteral">&quot;Mass [g]&quot;</span>);</div>
</div><!-- fragment --><p>producing the following figure:</p>
<p> 
<div class="image">
<a href="img/equilibrium-path-calcite-hcl-4.svg"
    data-fancybox="gallery1"
    data-caption="Tracing the dissolved mass of calcite with the gradual addition of HCl.">
    <img src="img/equilibrium-path-calcite-hcl-4.svg" width=400></a>
</div>
</p>
<dl class="section note"><dt>Note</dt><dd>Check class ChemicalQuantity for a list of supported quantity names, their default units, and how they can be used in both ChemicalPlot and ChemicalOutput classes.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The equal sign (=) used to specify the units (e.g., <code>units=mmolal</code>, <code>units=celsius</code>) should not be separated by spaces.</dd></dl>
<p>To output quantities to a file or terminal during the calculation, use method EquilibriumPath::output, which returns an instance of class ChemicalOutput:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalOutput output = path.output();</div>
<div class="line">output.filename(<span class="stringliteral">&quot;result.txt&quot;</span>);</div>
<div class="line">output.add(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>, <span class="stringliteral">&quot;Cl [mmol]&quot;</span>);</div>
<div class="line">output.add(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca [mmolal]&quot;</span>);</div>
<div class="line">output.add(<span class="stringliteral">&quot;pH&quot;</span>);</div>
<div class="line">output.add(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>);</div>
</div><!-- fragment --><p>The method ChemicalOutput::add adds a quantity to be output to the file <code>result.txt</code> (i.e., the file name specified in the call to method ChemicalOutput::file). Each call to ChemicalOutput::add results in a new column of data in the output file, like shown below:</p>
<div class="fragment"><div class="line">Cl [mmol]           Ca [mmolal]         pH                  speciesMass(Calcite units=g)</div>
<div class="line">1.1e-16             0.134437            9.78558             0.986545</div>
<div class="line">6.3132e-06          0.134439            9.78557             0.986544</div>
<div class="line">9.55315e-05         0.134467            9.7853              0.986542</div>
<div class="line">0.000987715         0.134742            9.78268             0.986514</div>
<div class="line">0.00990955          0.137677            9.7559              0.98622</div>
<div class="line">0.029156            0.144655            9.69602             0.985522</div>
<div class="line">0.0484024           0.15261             9.63351             0.984726</div>
<div class="line">0.100331            0.179333            9.45629             0.982051</div>
<div class="line">0.152259            0.213487            9.27833             0.978633</div>
<div class="line">0.204187            0.253494            9.11218             0.974629</div>
<div class="line">0.256115            0.297405            8.96347             0.970234</div>
<div class="line">0.308043            0.343719            8.83241             0.965598</div>
<div class="line">0.397568            0.42662             8.6418              0.957301</div>
<div class="line">0.487093            0.511357            8.48573             0.94882</div>
<div class="line">0.531083            0.553286            8.41877             0.944623</div>
<div class="line">0.575074            0.595296            8.35705             0.940419</div>
<div class="line">0.605964            0.624812            8.31647             0.937465</div>
<div class="line">0.636854            0.654325            8.27795             0.934511</div>
<div class="line">0.68543             0.700704            8.22109             0.929869</div>
<div class="line">0.734007            0.747012            8.16829             0.925234</div>
<div class="line">0.797192            0.807094            8.10488             0.919221</div>
<div class="line">0.860377            0.866961            8.04663             0.913229</div>
<div class="line">0.922344            0.925434            7.99384             0.907376</div>
<div class="line">0.984311            0.983645            7.94481             0.90155</div>
<div class="line">1                   0.998339            7.93293             0.900079</div>
</div><!-- fragment --><p>When two arguments are provided to method ChemicalOutput::add, the first one is a label used as the heading of the column of data in the output file, and the second argument is the name of the quantity to be output (e.g., <code>time</code>, <code>elementAmount(Cl)</code>, <code>ionicStrength</code>). When only one argument is provided, this single argument is both the label and the quantity name.</p>
<p>To output the result directly to the standard output, use:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalOutput output; {<span class="keyword">delete</span>}</div>
<div class="line">output.terminal(<span class="keyword">true</span>);</div>
</div><!-- fragment --><p>Finally, after all plots and output files have been configured, the equilibrium path can be calculated using:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">EquilibriumPath path; {<span class="keyword">delete</span>}</div>
<div class="line">path.solve(state1, state2);</div>
</div><!-- fragment --><h1></h1>
<p>We now finish by showing the Python code equivalent to the previous C++ code used for the equilibrium path calculation:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReaktoro.html">Reaktoro</a>; {<span class="keyword">delete</span>}</div>
<div class="line">from reaktoro <span class="keyword">import</span> *</div>
<div class="line"> </div>
<div class="line">editor = ChemicalEditor()</div>
<div class="line">; {<span class="keyword">delete</span>}</div>
<div class="line">ChemicalEditor editor; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addAqueousPhase(<span class="stringliteral">&quot;H O Ca C Cl&quot;</span>)</div>
<div class="line">; {<span class="keyword">delete</span>}</div>
<div class="line">editor.addMineralPhase(<span class="stringliteral">&quot;Calcite&quot;</span>)</div>
<div class="line">; {<span class="keyword">delete</span>}</div>
<div class="line"> </div>
<div class="line">system = ChemicalSystem;(editor)</div>
<div class="line"> </div>
<div class="line">problem1 = EquilibriumProblem;(system)</div>
<div class="line">problem1.setTemperature;(30.0, <span class="stringliteral">&quot;celsius&quot;</span>)</div>
<div class="line">problem1.setPressure;(1.0, <span class="stringliteral">&quot;bar&quot;</span>)</div>
<div class="line">problem1.add;(<span class="stringliteral">&quot;H2O&quot;</span>, 1, <span class="stringliteral">&quot;kg&quot;</span>)</div>
<div class="line">problem1.add;(<span class="stringliteral">&quot;CaCO3&quot;</span>, 1, <span class="stringliteral">&quot;g&quot;</span>)</div>
<div class="line"> </div>
<div class="line">problem2 = EquilibriumProblem;(system)</div>
<div class="line">problem2.setTemperature;(30.0, <span class="stringliteral">&quot;celsius&quot;</span>)</div>
<div class="line">problem2.setPressure;(1.0, <span class="stringliteral">&quot;bar&quot;</span>)</div>
<div class="line">problem2.add;(<span class="stringliteral">&quot;H2O&quot;</span>, 1, <span class="stringliteral">&quot;kg&quot;</span>)</div>
<div class="line">problem2.add;(<span class="stringliteral">&quot;CaCO3&quot;</span>, 1, <span class="stringliteral">&quot;g&quot;</span>)</div>
<div class="line">problem2.add;(<span class="stringliteral">&quot;HCl&quot;</span>, 1, <span class="stringliteral">&quot;mmol&quot;</span>)</div>
<div class="line"> </div>
<div class="line">state1 = equilibrate(problem1)</div>
<div class="line">state2 = equilibrate(problem2)</div>
<div class="line"> </div>
<div class="line">path = EquilibriumPath(system)</div>
<div class="line">;{<span class="keyword">delete</span>}</div>
<div class="line"> </div>
<div class="line">plot1 = path.plot()</div>
<div class="line">plot1.x;(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>)</div>
<div class="line">plot1.y;(<span class="stringliteral">&quot;pH&quot;</span>)</div>
<div class="line">plot1.xlabel;(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>)</div>
<div class="line">plot1.ylabel;(<span class="stringliteral">&quot;pH&quot;</span>)</div>
<div class="line">plot1.showlegend;(False)</div>
<div class="line"> </div>
<div class="line">plot2 = path.plot()</div>
<div class="line">plot2.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>)</div>
<div class="line">plot2.y(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca&quot;</span>)</div>
<div class="line">plot2.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>)</div>
<div class="line">plot2.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>)</div>
<div class="line">plot2.legend(<span class="stringliteral">&quot;right center&quot;</span>)</div>
<div class="line"> </div>
<div class="line">plot3 = path.plot()</div>
<div class="line">plot3.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>)</div>
<div class="line">plot3.y(<span class="stringliteral">&quot;speciesMolality(CO2(aq) units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO2(aq)&quot;</span>)</div>
<div class="line">plot3.y(<span class="stringliteral">&quot;speciesMolality(CO3-- units=mmolal)&quot;</span>, <span class="stringliteral">&quot;CO3--&quot;</span>)</div>
<div class="line">plot3.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>)</div>
<div class="line">plot3.ylabel(<span class="stringliteral">&quot;Concentration [mmolal]&quot;</span>)</div>
<div class="line">plot3.legend(<span class="stringliteral">&quot;right top&quot;</span>)</div>
<div class="line"> </div>
<div class="line">plot4 = path.plot()</div>
<div class="line">plot4.x(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>)</div>
<div class="line">plot4.y(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>, <span class="stringliteral">&quot;Calcite&quot;</span>)</div>
<div class="line">plot4.xlabel(<span class="stringliteral">&quot;HCl [mmol]&quot;</span>)</div>
<div class="line">plot4.ylabel(<span class="stringliteral">&quot;Mass [g]&quot;</span>)</div>
<div class="line"> </div>
<div class="line">output = path.output()</div>
<div class="line">output.filename(<span class="stringliteral">&quot;result.txt&quot;</span>)</div>
<div class="line">output.add(<span class="stringliteral">&quot;elementAmount(Cl units=mmol)&quot;</span>, <span class="stringliteral">&quot;Cl [mmol]&quot;</span>)</div>
<div class="line">output.add(<span class="stringliteral">&quot;elementMolality(Ca units=mmolal)&quot;</span>, <span class="stringliteral">&quot;Ca [mmolal]&quot;</span>)</div>
<div class="line">output.add(<span class="stringliteral">&quot;pH&quot;</span>)</div>
<div class="line">output.add(<span class="stringliteral">&quot;speciesMass(Calcite units=g)&quot;</span>)</div>
<div class="line"> </div>
<div class="line">path.solve(state1, state2)</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
</div> <!-- DOXYSTRAP RELATED -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 15 2021 11:14:40 for Reaktoro by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
